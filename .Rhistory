names(heimat_per) <- c("Liegt Ihre Heimat in der Bodenseeregion?", "Percentage")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
names(einheit_per) <- c("Empfinden Sie die Bodenseeregion als eine Einheit?", "Percentage")
heimat_per
einheit_per
typeof(heimat_per)
df <- data.frame(matrix(unlist(heimat_per), nrow=length(heimat_per), byrow=TRUE))
typeof
typeof(df)
library(kableExtra)
library(dplyr)
heimat_per <- as.data.frame(prop.table(table(general$hf_tourist_einheimisch)))
names(heimat_per) <- c(" Liegt Ihre Heimat in der Bodenseeregion? ", " Percentage ")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
names(einheit_per) <- c(" Empfinden Sie die Bodenseeregion als eine Einheit? ", " Percentage ")
Einheit_tbl <- einheit_per %>%
kbl() %>%
kable_paper("hover", full_width = F)
Heimat_tbl <- heimat_per %>%
kbl() %>%
kable_paper("hover", full_width = F)
knitr::kable(list(Einheit_tbl, Heimat_tbl))
library(kableExtra)
library(dplyr)
heimat_per <- as.data.frame(prop.table(table(general$hf_tourist_einheimisch)))
names(heimat_per) <- c(" Liegt Ihre Heimat in der Bodenseeregion? ", " Percentage ")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
names(einheit_per) <- c(" Empfinden Sie die Bodenseeregion als eine Einheit? ", " Percentage ")
Einheit_tbl <- einheit_per %>%
kbl() %>%
kable_paper("hover", full_width = F)
Heimat_tbl <- heimat_per %>%
kbl() %>%
kable_paper("hover", full_width = F)
t1 <- head(mtcars)[1:3]
t2 <- head(mtcars)[4:6]
knitr::kable(list(t1, t2))
knitr::kable(list(einheit_per, heimat_per))
library(kableExtra)
library(dplyr)
heimat_per <- as.data.frame(prop.table(table(general$hf_tourist_einheimisch)))
names(heimat_per) <- c(" Liegt Ihre Heimat in der Bodenseeregion? ", " Percentage ")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
names(einheit_per) <- c(" Empfinden Sie die Bodenseeregion als eine Einheit? ", " Percentage ")
# Einheit_tbl <- einheit_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
#
# Heimat_tbl <- heimat_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
knitr::kable(list(einheit_per, heimat_per)) %>%
kable_paper("hover", full_width = F)
einheit_per
einheit_per <- einheit_per[1:2,]
library(kableExtra)
library(dplyr)
heimat_per <- as.data.frame(prop.table(table(general$hf_tourist_einheimisch)))
names(heimat_per) <- c(" Liegt Ihre Heimat in der Bodenseeregion? ", " Percentage ")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
einheit_per <- einheit_per[1:2,]
names(einheit_per) <- c(" Empfinden Sie die Bodenseeregion als eine Einheit? ", " Percentage ")
# Einheit_tbl <- einheit_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
#
# Heimat_tbl <- heimat_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
knitr::kable(list(einheit_per, heimat_per)) %>%
kable_paper("hover", full_width = F)
knitr::kable(list(heimat_per,einheit_per))
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
View(data_all)
View(general)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(ggplot2)
# create custom theme and apply it to every plot
####################################################################################
custom_theme <- theme(panel.border = element_blank(),legend.title = element_blank(),
plot.title = element_text(size = 11, hjust = 0.5, face = "bold"))
####################################################################################
# Heimat oder nicht
pie_heimat <- ggplot(data=general, aes(x = "", fill = hf_tourist_einheimisch)) +
geom_bar(position = "fill", width = 1) +
coord_polar(theta = "y") +
xlab("") + ylab("") + custom_theme +
ggtitle("Liegt Ihre Heimat in der Bodenseeregion?") + scale_fill_brewer(palette="Set1")
# Einheit oder nicht -- wenn der Heimat in der Bodenseeregion liegt
pie_einheit <- ggplot(data=general, aes(x = "", fill = hf_einheit)) +
geom_bar(position = "fill", width = 1) +
coord_polar(theta = "y") +
xlab("") + ylab("") + custom_theme +
ggtitle("Empfinden Sie die Bodenseeregion – trotz der Zugehörigkeit zu vier Staaten – als eine Einheit?") + scale_fill_brewer(palette="Set1")
# Geschlecht Distribution
general$sdf_geschlecht <- as.factor(general$sdf_geschlecht)
levels(general$sdf_geschlecht) <- c("diverse", "männlich", "weiblich") # rename the levels
general$sdf_geschlecht <- factor(general$sdf_geschlecht, levels = c("männlich", "weiblich","diverse")) # reorder the levels
pie_geschlecht <- ggplot(data=general, aes(x = "", fill = sdf_geschlecht)) +
geom_bar(position = "fill", width = 1) +
coord_polar(theta = "y") +
xlab("") + ylab("") + custom_theme +
ggtitle("Was ist Ihr Geschlecht?") + scale_fill_brewer(palette="Set1")
pie_heimat
pie_einheit
pie_geschlecht
# Jahrgang
general$sdf_jahrgang <- as.factor(general$sdf_jahrgang)
general$sdf_jahrgang <- factor(general$sdf_jahrgang, levels = c("<18","18_29","30_60",">60","NA"))
plot_jahrgang <- ggplot(data = general) + geom_bar(aes(sdf_jahrgang, fill = sdf_geschlecht)) + ggtitle("Wie alt sind Sie?") + scale_fill_brewer(palette="Set1") + theme(axis.title.x=element_blank(),panel.border = element_blank(),legend.title = element_blank(),plot.title = element_text(size = 11, hjust = 0.5, face = "bold"))
# Grenzverkehr
general$hf_grenzverkehr <- as.factor(general$hf_grenzverkehr)
general$hf_grenzverkehr <- factor(general$hf_grenzverkehr, levels = c("weiss nicht","ungenügend","mangelhaft","ausreichend","befriedigend","gut","sehr gut"))
plot_grenzverkehr <- ggplot(data = general) + geom_bar(aes(hf_grenzverkehr, fill = hf_tourist_einheimisch)) + ggtitle("Wie bewerten Sie den grenzüberschreitenden öffentlichen Verkehr?") + scale_fill_brewer(palette="Set1", name = "Einheimisch?") +
theme(axis.title.x=element_blank(),panel.border = element_blank(),plot.title =  element_text(size = 11, hjust = 0.5, face = "bold"))
plot_jahrgang
plot_grenzverkehr
library(kableExtra)
library(dplyr)
heimat_per <- as.data.frame(prop.table(table(general$hf_tourist_einheimisch)))
names(heimat_per) <- c(" Liegt Ihre Heimat in der Bodenseeregion? ", " Percentage ")
einheit_per <- as.data.frame(prop.table(table(general$hf_einheit)))
einheit_per <- einheit_per[1:2,]
names(einheit_per) <- c(" Empfinden Sie die Bodenseeregion als eine Einheit? ", " Percentage ")
# Einheit_tbl <- einheit_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
#
# Heimat_tbl <- heimat_per %>%
#   kbl() %>%
#   kable_paper("hover", full_width = F)
knitr::kable(list(heimat_per,einheit_per)) %>%
kable_paper("hover", full_width = F)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
View(data_all)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
View(data_all)
View(general)
ggplot(data = general) + geom_bar(aes(hf_einheit), fill = general$sdf_jahrgang)
ggplot(data = general) + geom_bar(aes(hf_einheit))
ggplot(data=general, aes(x = "", fill = hf_einheit)) +
geom_bar(position = "fill", width = 1)
ggplot(data=general, aes(x = hf_einheit, fill = hf_einheit)) +
geom_bar(position = "fill", width = 1)
ggplot(data=general, aes(x = hf_einheit, fill = general$sdf_jahrgang)) +
geom_bar(position = "fill", width = 1)
ggplot(data=general, aes(x = hf_einheit, fill = general$sdf_jahrgang)) +
geom_bar()
ggplot(general, aes(x = hf_einheit, fill = sdf_jahrgang), xlab="Age Group") +
geom_bar(stat="identity", width=.5, position = "dodge")
count(general$hf_einheit)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df
melt(df)
library(reshape2)
melt(df)
df
df1 <- melt(df)
View(df1)
View(df)
df <- df %>% group_by(sdf_jahrgang)
df
View(df)
df1= data.frame(Name=c('James','Paul','Richards','Marico','Samantha','Ravi','Raghu','Richards','George','Ema','Samantha','Catherine'),
State=c('Alaska','California','Texas','North Carolina','California','Texas','Alaska','Texas','North Carolina','Alaska','California','Texas'),
Sales=c(14,24,31,12,13,7,9,31,18,16,18,14))
df1
df1= data.frame(Name=c('James','Paul','Richards','Marico','Samantha','Ravi','Raghu','Richards','George','Ema','Samantha','Catherine'),
State=c('Alaska','California','Texas','North Carolina','California','Texas','Alaska','Texas','North Carolina','Alaska','California','Texas'),
Sales=c(14,24,31,12,13,7,9,31,18,16,18,14))
aggregate(df1$Sales, by=list(df1$State), FUN=length)
aggregate(df1$Sales, by=list(df1$State), FUN=count)
df <- df %>% group_by(hf_einheit,sdf_jahrgang)
View(df)
df <- df %>% group_by(hf_einheit,sdf_jahrgang) %>% summarise()
df <- df %>% group_by(hf_einheit,sdf_jahrgang) %>% summarise(count_sales = n())
View(df)
View(data_all)
View(df)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(hf_einheit) %>% summarise(count_sales = n())
View(df)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang) %>% summarise(occurences = n())
View(df)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n())
View(df)
library(reshape2)
ggplot(data = general) + geom_bar(aes(hf_einheit))
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = occurences / sum(occurences))
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = occurences / sum(occurences))
View(df)
sum(df$occurences)
19/543
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = occurences / 543))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = occurences / 543)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = occurences / 543)
View(df)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
View(df)
ggplot(data = df) + geom_histogram(aes(occurences))
ggplot(data = df) + geom_histogram(aes(occurences), fill = sdf_jahrgang)
ggplot(data = df) + geom_histogram(aes(occurences), fill = df$sdf_jahrgang)
ggplot(data = df) + geom_histogram(aes(occurences), fill = df$sdf_jahrgang)
ggplot(df, aes(sdf_jahrgang))
g + g + geom_bar()
g <- ggplot(df, aes(sdf_jahrgang))
g + g + geom_bar()
g + geom_bar()
g + geom_bar(aes(weight = hf_einheit))
g <- ggplot(df, aes(sdf_jahrgang))
g
g + geom_bar(aes(fill = hf_einheit))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
g <- ggplot(df, aes(sdf_jahrgang))
g + geom_bar(aes(fill = drv))
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df <- df %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
g <- ggplot(df, aes(sdf_jahrgang))
View(df)
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df1 <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
g <- ggplot(df, aes(sdf_jahrgang))
df1
View(df1)
df1_ja <- filter(df1, df1$hf_einheit == "ja")
df1_ja <- select(df1, df1$hf_einheit == "ja")
df1_ja <- select(df1, hf_einheit == "ja")
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
View(df1_ja)
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
View(df1_nein)
ggplot(df1_ja) + geom_bar(aes(df1_ja$sdf_jahrgang))
ggplot(df1_ja) + geom_bar()
ggplot(df1_ja) + geom_col()
ggplot(df1_ja, aes(sdf_jahrgang)) + geom_bar()
ggplot(df1_ja, aes(hf_einheit)) + geom_bar()
View(df1_ja)
ggplot(df1_ja, aes(percent)) + geom_bar(aes(fill = sdf_jahrgang))
ggplot(df1_ja) + geom_bar(aes(x = sdf_jahrgang, y = percent))
ggplot(df1_ja) + geom_col(aes(x = sdf_jahrgang, y = percent))
View(df1)
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent))
ggplot(df1_ja) + geom_col(aes(x = sdf_jahrgang, y = percent))
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df1 <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
ggplot(df1_ja) + geom_col(aes(x = sdf_jahrgang, y = percent))
View(df1)
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent))
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent), fill = hf_einheit)
View(df1)
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent, fill = hf_einheit))
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) +
geom_text(aes(label = percent), vjust = -0.5)
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent, fill = hf_einheit))
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) +
geom_text(aes(label = df1$percent), vjust = -0.5)
ggplot(df1) + geom_col(aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) +
geom_text(aes(label = percent), vjust = 1.5, colour = "white")
ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent), vjust = 1.5, colour = "white")
ggplot(df1, aes(x = sdf_jahrgang, y = round(percent, digits = 2), fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent), vjust = 1.5, colour = "white")
View(df1)
df1$percent <- round(df1$percent,2)
ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent), vjust = 1.5, colour = "white")
ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent), vjust = 2, colour = "black")
ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent))
library(reshape2)
df1 <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df1$percent <- round(df1$percent,2)
p_together <- ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent))
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
ggplot(df1_ja) + geom_col(aes(x = sdf_jahrgang, y = percent))
ggplot(df1_ja, aes(x = sdf_jahrgang, y = percent)) + geom_col()
ggplot(df1_ja, aes(x = sdf_jahrgang, y = percent)) + geom_col(fill = sdf_jahrgang)
ggplot(df1_ja, aes(x = sdf_jahrgang, y = percent)) + geom_col() +
scale_fill_brewer(palette="Set1")
ggplot(df1_ja, aes(x = sdf_jahrgang, y = percent)) + geom_col(aes(fill = sdf_jahrgang))
ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
View(df1)
test <- c(1,2,3,NA)
test
t <- is.na(test)
t
t <- na.omit(test)
t
t
ggplot(df1_ja, aes(x = sdf_jahrgang, y = percent)) + geom_col(aes(fill = sdf_jahrgang))
test <- na.omit(df1_ja)
View(test)
ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
library(gridExtra)
p1 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p2 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
grid.arrange(p1, p2, nrow = 1)
print(t)
library(gridExtra)
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
test <- na.omit(df1_ja)
p1 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p2 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
t <- grid.arrange(p1, p2, nrow = 1)
print(t)
library(gridExtra)
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
test <- na.omit(df1_ja)
p1 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p2 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
t <- grid.arrange(p1, p2, nrow = 1)
t
library(reshape2)
df1 <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df1$percent <- round(df1$percent,2)
p_together <- ggplot(df1, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p_together
df1_clean <- na.omit(df1)
View(df1_clean)
ggplot(df1_clean, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
View(data_all)
wohnort <- select(data_all, c("sdf_wohnort"))
View(wohnort)
df2 <- cbind(df1, wohnort)
df2 <- cbind(general, wohnort)
View(df2)
df2 <- select(data_all, c("hf_einheit", "sdf_wohnort", "sdf_jahrgang"))
View(df2)
df2 <- select(data_all, c("hf_einheit", "sdf_wohnort", "sdf_jahrgang"))
df2 <- select(data_all, c("hf_einheit", "sdf_wohnort", "sdf_jahrgang"))
df2 <- df2 %>% group_by(hf_einheit,sdf_wohnort) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
View(df2)
ggplot(df2, aes(sdf_wohnort, percent)) + geom_col()
View(df2)
ggplot(df2, aes(sdf_wohnort, percent)) + geom_col()
View(data_all)
names(data_all)
df2 <- select(data_all, c("hf_einheit", "sdf_wohnort", "sdf_jahrgang"))
df2 <- df2 %>% group_by(hf_einheit,sdf_wohnort) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
ggplot(df2, aes(sdf_wohnort, percent)) + geom_col()
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
general <- data_all %>% select(., c("hf_tourist_einheimisch","hf_einheit","hf_einheit_ja",
"hf_einheit_nein","hf_grenzverkehr","sdf_geschlecht","sdf_jahrgang"))
# general$hf_einheit[is.na(general$hf_einheit)] <- "Kein Wert"
# # Create a factor with the wrong order of levels
# general$hf_einheit <- factor(general$hf_einheit, levels = c("ja", "nein", "kein Wert"))
library(reshape2)
df1 <- general %>% select(c("hf_einheit","sdf_jahrgang"))
df1 <- df1 %>% group_by(sdf_jahrgang,hf_einheit) %>% summarise(occurences = n()) %>%
mutate(percent = (occurences / 543)*100)
df1$percent <- round(df1$percent,2)
df1_clean <- na.omit(df1)
p_together <- ggplot(df1_clean, aes(x = sdf_jahrgang, y = percent, fill = hf_einheit)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p_together
library(gridExtra)
df1_ja <- dplyr::filter(df1, hf_einheit == "ja")
df1_nein <- dplyr::filter(df1, hf_einheit == "nein")
test <- na.omit(df1_ja)
p1 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p2 <- ggplot(test, aes(x = sdf_jahrgang, y = percent, fill = sdf_jahrgang)) + geom_col() +
geom_text(aes(label = percent),vjust = -0.2)
p1
