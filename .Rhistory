filter(., te_tourist_einheimisch == "tourist") %>% na.omit()
dp9 <- dp9 %>% group_by(te_jahreszeit_ja_nein,te_tourist_einheimisch) %>%
summarise(occurences = n()) %>% mutate(
percent = round((occurences/170)*100,2)
)
p9_ferien <- ggplot(data = dp9, aes(x = "", y = percent, fill = te_jahreszeit_ja_nein )) +
geom_bar(stat = "identity", position = position_fill()) +
geom_text(aes(label = percent), position = position_fill(vjust = 0.5), size = 3) +
coord_polar(theta = "y") + ggtitle("Würden Sie noch einmal zu einer anderen Jahreszeit\nin der Bodenseeregion Ferien machen?") +  ylab("% Prozent") + scale_fill_manual(values = c("palegreen1", "pink1", "gray80")) +
theme(plot.title = element_text(size = 11, face = "bold"),
axis.title.x = element_text(size = 10,face = "bold"),
axis.title.y = element_blank(),
legend.title = element_blank(), legend.position='bottom',
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank())
ggsave("to_deliver/ferien_ja_nein.pdf")
dp9 <- data_all %>% select(c("te_jahreszeit_ja_nein","te_tourist_einheimisch")) %>%
filter(., te_tourist_einheimisch == "tourist") %>% na.omit()
dp9 <- dp9 %>% group_by(te_jahreszeit_ja_nein,te_tourist_einheimisch) %>%
summarise(occurences = n()) %>% mutate(
percent = round((occurences/170)*100,2)
)
p9_ferien <- ggplot(data = dp9, aes(x = "", y = percent, fill = te_jahreszeit_ja_nein )) +
geom_bar(stat = "identity", position = position_fill()) +
geom_text(aes(label = percent), position = position_fill(vjust = 0.5), size = 3) +
coord_polar(theta = "y") + ggtitle("Würden Sie noch einmal zu einer anderen Jahreszeit in der\nBodenseeregion Ferien machen?") +  ylab("% Prozent") + scale_fill_manual(values = c("palegreen1", "pink1", "gray80")) +
theme(plot.title = element_text(size = 11, face = "bold"),
axis.title.x = element_text(size = 10,face = "bold"),
axis.title.y = element_blank(),
legend.title = element_blank(), legend.position='bottom',
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank())
ggsave("to_deliver/ferien_ja_nein.pdf")
df_f3 <- data_all %>% select(., c("te_tourist_einheimisch","te_anrainerstaat",
"te_anrainer_orte")) %>% filter(.,te_tourist_einheimisch=="tourist")
df_f3_1 <- df_f3 %>% select(.,"te_anrainerstaat") %>% na.omit() %>%
table() %>% as.data.frame()
names(df_f3_1) <- c("Besuch","Freq")
df_f3_1 <- df_f3_1 %>% mutate(
percent = round((Freq/sum(Freq)*100),2)
)
p_besuch <- ggplot(df_f3_1, aes(x = "", y = percent, fill = Besuch)) +
geom_col() + xlab(" ") + ylab("% Prozent") +
geom_text(aes(label = percent),
position = position_stack(vjust = 0.5), size = 3) + ggtitle("Planen Sie während Ihres aktuellen Aufenthalts einen Besuch\nin einem anderen Anrainerstaat des Bodensees?") +
coord_polar(theta = "y") + scale_fill_manual(values = c("lightsteelblue2", "lightpink2")) +
theme(plot.title = element_text(size = 11, face = "bold"),
legend.title = element_blank(), legend.position = "bottom",
axis.title.x = element_text(size = 10,face = "bold"),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank())
#ggsave("to_deliver/besuch_bodensee.pdf")
##### Wenn JA
df_f3_2 <- df_f3 %>% select(.,"te_anrainerstaat","te_anrainer_orte") %>% na.omit()
orte <- unlist(strsplit(df_f3_2$te_anrainer_orte, ",")) %>% as.data.frame()
orte <- table(orte) %>% as.data.frame()
orte <- orte %>% mutate(
percent = round((Freq/sum(Freq)*100),2)
)
levels(orte$orte) <- c("Allensbach","Bregenz","Dornbirn","Feldkirch","Friedrichshafen","Konstanz",
"Kreuzlingen","Lindau","Meersburg","Radolfzell","Ravensburg","Romanshorn",
"Singen","Sonstiges","St_gallen","Stein_am_rhein","Überlingen","Winterthur")
p_orte <- ggplot(orte, aes(percent, orte, fill=orte, alpha = 0.85)) + geom_col()  +
xlab("Prozent %") + ylab(" ") +
geom_text(aes(label = percent), size = 3,hjust=-0.5) +
ggtitle("An welchen Orten planen Sie während Ihres aktuellen Aufenthalts\neinen Besuch in einem anderen Anrainerstaat des Bodensees?") + xlim(0,30) +
theme(plot.title = element_text(size = 11, face = "bold"),legend.position="none",
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10,face = "bold"),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10,face = "bold"))
ggsave("to_deliver/besuch_bodensee_JA.pdf")
dp10 <- data_all %>% select(c("te_jahreszeit_attraktiv","te_jahreszeit_fruehling","te_jahreszeit_sommer",
"te_jahreszeit_herbst","te_jahreszeit_winter"))
View(dp10)
dp11 <- data_all %>% select(c("te_anrainer"))
View(dp11)
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort"))
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort")) %>% na.omit()
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort"))
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort","te_tourist_einheimisch"))
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist")
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist" & is.na(te_anrainer))
View(dp11)
dp11 <- data_all %>% select(c("te_anrainer", "sdf_wohnort","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist" & !is.na(te_anrainer))
dp11 <- data_all %>% select(c("te_anrainer", "te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist" & !is.na(te_anrainer))
View(data_all)
dp11 <- data_all %>% select(c("te_anrainer", "te_tourist_einheimisch","te_wohnort"))
dp11 <- data_all %>% select(c("te_anrainer", "te_tourist_einheimisch","befragungsort_list"))
View(dp11)
dp11 <- data_all %>% select(c("te_anrainer", "te_tourist_einheimisch","befragungsort_list")) %>%
filter(.,te_tourist_einheimisch == "tourist" & !is.na(te_anrainer) & !is.na(befragungsort_list))
dp11_filter <- dp11 %>% select(!te_tourist_einheimisch)
View(dp11_filter)
dp11_filter <- dp11 %>% select(!te_tourist_einheimisch) %>% group_by(te_anrainer,befragungsort_list)
install.packages("circlize")
library(circlize)
library(circlize)
chordDiagram(dp11_filter)
antworten <- unlist(strsplit(dp11_filter$te_anrainer, ",")) %>% as.data.frame()
View(antworten)
View(dp11)
dp11_breg <- dp11 %>% filter(., befragungsort_list == "Bregenz")
dp11_dorn <- dp11 %>% filter(., befragungsort_list == "Dornbirn")
dp11_kons <- dp11 %>% filter(., befragungsort_list == "Konstanz")
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
dp11_roman <- dp11 %>% filter(., befragungsort_list == "Romanshorn")
dp11_stga <- dp11 %>% filter(., befragungsort_list == "St. Gallen")
View(dp11_breg)
View(dp11_dorn)
View(dp11_kons)
View(dp11_meer)
View(dp11_roman)
dp11_breg <- dp11 %>% filter(., befragungsort_list == "Bregenz") %>%
unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame()
View(dp11_breg)
dp11_breg <- dp11 %>% filter(., befragungsort_list == "Bregenz") %>%
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame()
dp11_breg <- dp11 %>% filter(., befragungsort_list == "Bregenz")
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame()
View(antworten_breg)
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Bregenz")
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Bregenz") %>% names(antworten_breg[1]) = "Antwort"
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Bregenz") %>% group_by(.,Ort) %>% summarise(occurences = n())
dp11_breg <- dp11 %>% filter(., befragungsort_list == "Bregenz")
antworten_breg <- unlist(strsplit(dp11_breg$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Bregenz")
View(antworten_breg)
names(antworten_breg)
names(antworten_breg)[1] <- "Antwort"
View(antworten_breg)
antworten_breg <- antworten_breg %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(antworten_breg)
dp11_dorn <- dp11 %>% filter(., befragungsort_list == "Dornbirn")
antworten_dorn <- unlist(strsplit(dp11_dorn$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Dornbin")
names(antworten_dorn)[1] <- "Antwort"
antworten_dorn <- antworten_dorn %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(dp11_dorn)
View(antworten_dorn)
antworten_dorn <- antworten_dorn %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
dp11_kons <- dp11 %>% filter(., befragungsort_list == "Konstanz")
antworten_kons <- unlist(strsplit(dp11_kons$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Konstanz")
names(antworten_kons)[1] <- "Antwort"
antworten_kons <- antworten_kons %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(antworten_kons)
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
antworten_meer <- unlist(strsplit(dp11_meer$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
names(dp11_meer)[1] <- "Antwort"
dp11_meer <- dp11_meer %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
antworten_meer <- unlist(strsplit(dp11_meer$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
View(antworten_meer)
names(dp11_meer)[1] <- "Antwort"
dp11_meer <- dp11_meer %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(dp11_meer)
# Meersburg
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
antworten_meer <- unlist(strsplit(dp11_meer$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
antworten_meer <- unlist(strsplit(dp11_meer$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
names(dp11_meer)[1] <- "Antwort"
antworten_meer <- antworten_meer %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
dp11_meer <- dp11 %>% filter(., befragungsort_list == "Meersburg")
antworten_meer <- unlist(strsplit(dp11_meer$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
names(antworten_meer)[1] <- "Antwort"
antworten_meer <- antworten_meer %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(antworten_meer)
# Romanshorn
dp11_roman <- dp11 %>% filter(., befragungsort_list == "Romanshorn")
dp11_roman <- dp11 %>% filter(., befragungsort_list == "Romanshorn")
antworten_roman <- unlist(strsplit(dp11_roman$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
names(antworten_roman)[1] <- "Antwort"
antworten_roman <- antworten_roman %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(antworten_roman)
dp11_stga <- dp11 %>% filter(., befragungsort_list == "St. Gallen")
antworten_stgal <- unlist(strsplit(dp11_stga$te_anrainer, ",")) %>% as.data.frame() %>%
mutate(Ort = "Meersburg")
names(antworten_stgal)[1] <- "Antwort"
antworten_stgal <- antworten_stgal %>% group_by(Antwort,Ort) %>% summarise(occurences = n())
View(antworten_stgal)
dp11_together <- rbind(antworten_breg,antworten_dorn,antworten_kons,antworten_meer,
antworten_roman,antworten_stgal)
View(dp11_together)
chordDiagram(dp11_together)
View(dp11_together)
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "nein"] <- "Nein, kann ich mir nicht vorstellen"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
chordDiagram(dp11_together)
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "nein"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
chordDiagram(dp11_together)
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
chordDiagram(dp11_together)
?chordDiagram
chordDiagram(dp11_together,annotationTrack = c("name"))
chordDiagram(dp11_together,annotationTrack = c("name", "grid", "axis"))
chordDiagram(dp11_together)
chordDiagram(dp11_together, link.auto = F)
chordDiagram(dp11_together)
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
ggsave("to_deliver/chordDiagram_1.pdf")
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
?chordDiagram
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "title")
dev.off()
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "title",size = 11, face = "bold")
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "Könnten Sie sich vorstellen in einem anderen Teil der Bodenseeregion Ferien zu machen?",size = 11, face = "bold")
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "Könnten Sie sich vorstellen in einem\nanderen Teil der Bodenseeregion Ferien zu machen?",
size = 10, face = "bold")
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "Könnten Sie sich vorstellen in einem anderen Teil der Bodenseeregion Ferien zu machen?",
size = 8, face = "bold")
dev.off()
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
title(main = "Könnten Sie sich vorstellen in einem anderen Teil\nder Bodenseeregion Ferien zu machen?",
size = 8, face = "bold",vjust = -2)
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord1.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord_ferien.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord_ferien.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord_ferien.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
dp11_together$Antwort[dp11_together$Antwort == "ja_au"] <- "Ja, im österreichischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_ch"] <- "Ja, im schweizerischen Teil"
dp11_together$Antwort[dp11_together$Antwort == "ja_de"] <- "Ja, im deutschen Teil"
dp11_together$Antwort[dp11_together$Antwort == "Nein, kann ich mir nicht vorstellen"] <- "Nein"
dp11_together$Antwort[dp11_together$Antwort == "vielleicht"] <- "Vielleicht"
pdf(file = "to_deliver/chord_ferien.pdf",
width = 7, # The width of the plot in inches
height = 7) # The height of the plot in inches
chordDiagram(dp11_together,annotationTrack = c("name","grid"))
dev.off()
install.packages("wordcloud")
library(wordcloud)
install.packages("RColorBrewer")
library(RColorBrewer)install.packages("wordcloud2")
install.packages("RColorBrewer")
library(wordcloud)
library(RColorBrewer)
install.packages("wordcloud2")
library(wordcloud2)
install.packages("tm")
library(tm)
rquery.wordcloud(dp12_de, type=c("text", "url", "file"),
lang="german", excludeWords = NULL,
textStemming = FALSE,  colorPalette="Dark2",
max.words=200)
wordcloud(dp12_au)
dp12 <- data_all %>% select(.,c("te_anrainer_de","te_anrainer_au","te_anrainer_ch","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist")
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
library(reshape)
library(tidyr)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
df_f1 <- data_all %>% select(., c("te_tourist_einheimisch","sdf_geschlecht",
"sdf_jahrgang", "te_gruende_tourist")) %>%
filter(., te_tourist_einheimisch == "tourist") %>% group_by(
sdf_jahrgang, te_gruende_tourist)
# Aus welchen Gründen haben Sie sich für einen Ausflug in die Bodenseeregion entschieden?
gruende <- unlist(strsplit(df_f1$te_gruende_tourist, ",")) %>% as.data.frame()
names(gruende) <- "Ausflug_Gruende"
gruende <- table(gruende) %>% as.data.frame()
#gruende$Ausflug_Gruende <- as.character(gruende$Ausflug_Gruende)
gruende <- gruende %>% mutate(
percent = round((Freq/sum(Freq)*100),2)
)
levels(gruende$gruende)[1:14] <- c("Erholung","Freunde","Gastronomie","Gesundheit","Gewohnheit",
"Inspiration","Internationalität","Kultur","Nähe","Natur",
"Shopping","Sonstiges","Sport","Ich weiss nicht")
p_gruende <- ggplot(gruende, aes(percent, gruende, fill=gruende,alpha = 0.85)) + geom_col()  +
xlab("Prozent %") + ylab(" ") +
geom_text(aes(label = percent), size = 3,hjust=-0.5) +
ggtitle("Aus welchen Gründen haben Sie sich für einen Ausflug in die\nBodenseeregion entschieden?") + xlim(0,30) +
theme(plot.title = element_text(size = 11, face = "bold"),legend.position="none",
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10,face = "bold"),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10,face = "bold"))
#ggsave("to_deliver/grund_ausflug.pdf")
# df_gruende <- gruende %>% as.data.frame()
#write.csv(df_gruende,"to_deliver/tables/gruende_ausflug.csv", row.names = F)
dp12 <- data_all %>% select(.,c("te_anrainer_de","te_anrainer_au","te_anrainer_ch","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist")
dp12_de <- dp12 %>% select(., c("te_anrainer_de")) %>% na.omit()
dp12_ch <- dp12 %>% select(.,c("te_anrainer_ch")) %>% na.omit()
dp12_au <- dp12 %>% select(.,c("te_anrainer_au")) %>% na.omit()
wordcloud(dp12_au$te_anrainer_au)
wordcloud(dp12_au$te_anrainer_de)
wordcloud(dp12_de$te_anrainer_de)
tt <- as.character(dp12_au$te_anrainer_au)
wordcloud(tt)
tt
typeof(tt)
length(tt)
is.vector(as.character(TT))
is.vector(as.character(tt))
df_au <- as.data.frame(dp12_au)
View(df_au)
write.csv(dp12_de,"to_deliver/tables/gruende_keinFer_de.csv", row.names = F)
write.csv(dp12_ch,"to_deliver/tables/gruende_keinFer_ch.csv", row.names = F)
write.csv(dp12_au,"to_deliver/tables/gruende_keinFer_au.csv", row.names = F)
dp12 <- data_all %>% select(.,c("te_gruende_tourist")) %>%
filter(.,te_tourist_einheimisch == "tourist")
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
library(reshape)
library(tidyr)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
df_f1 <- data_all %>% select(., c("te_tourist_einheimisch","sdf_geschlecht",
"sdf_jahrgang", "te_gruende_tourist")) %>%
filter(., te_tourist_einheimisch == "tourist") %>% group_by(
sdf_jahrgang, te_gruende_tourist)
# Aus welchen Gründen haben Sie sich für einen Ausflug in die Bodenseeregion entschieden?
gruende <- unlist(strsplit(df_f1$te_gruende_tourist, ",")) %>% as.data.frame()
names(gruende) <- "Ausflug_Gruende"
gruende <- table(gruende) %>% as.data.frame()
#gruende$Ausflug_Gruende <- as.character(gruende$Ausflug_Gruende)
gruende <- gruende %>% mutate(
percent = round((Freq/sum(Freq)*100),2)
)
levels(gruende$gruende)[1:14] <- c("Erholung","Freunde","Gastronomie","Gesundheit","Gewohnheit",
"Inspiration","Internationalität","Kultur","Nähe","Natur",
"Shopping","Sonstiges","Sport","Ich weiss nicht")
p_gruende <- ggplot(gruende, aes(percent, gruende, fill=gruende,alpha = 0.85)) + geom_col()  +
xlab("Prozent %") + ylab(" ") +
geom_text(aes(label = percent), size = 3,hjust=-0.5) +
ggtitle("Aus welchen Gründen haben Sie sich für einen Ausflug in die\nBodenseeregion entschieden?") + xlim(0,30) +
theme(plot.title = element_text(size = 11, face = "bold"),legend.position="none",
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10,face = "bold"),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10,face = "bold"))
#ggsave("to_deliver/grund_ausflug.pdf")
# df_gruende <- gruende %>% as.data.frame()
#write.csv(df_gruende,"to_deliver/tables/gruende_ausflug.csv", row.names = F)
dp12 <- data_all %>% select(.,c("te_gruende_tourist")) %>%
filter(.,te_tourist_einheimisch == "tourist")
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch")) %>%
filter(.,te_tourist_einheimisch == "tourist")
View(dp12)
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","sdf_wohnort")) %>%
filter(.,te_tourist_einheimisch == "tourist")
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","sdf_wohnort"))
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list"))
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list")) %>%
filter(., te_tourist_einheimisch == "tourist")
library(readr)
library(ggplot2)
library(dplyr)
library(readxl)
library(reshape)
library(tidyr)
data_all <- read_xlsx("../data/DatenbefragungAll_xlsx.xlsx")
df_f1 <- data_all %>% select(., c("te_tourist_einheimisch","sdf_geschlecht",
"sdf_jahrgang", "te_gruende_tourist")) %>%
filter(., te_tourist_einheimisch == "tourist") %>% group_by(
sdf_jahrgang, te_gruende_tourist)
# Aus welchen Gründen haben Sie sich für einen Ausflug in die Bodenseeregion entschieden?
gruende <- unlist(strsplit(df_f1$te_gruende_tourist, ",")) %>% as.data.frame()
names(gruende) <- "Ausflug_Gruende"
gruende <- table(gruende) %>% as.data.frame()
#gruende$Ausflug_Gruende <- as.character(gruende$Ausflug_Gruende)
gruende <- gruende %>% mutate(
percent = round((Freq/sum(Freq)*100),2)
)
levels(gruende$gruende)[1:14] <- c("Erholung","Freunde","Gastronomie","Gesundheit","Gewohnheit",
"Inspiration","Internationalität","Kultur","Nähe","Natur",
"Shopping","Sonstiges","Sport","Ich weiss nicht")
p_gruende <- ggplot(gruende, aes(percent, gruende, fill=gruende,alpha = 0.85)) + geom_col()  +
xlab("Prozent %") + ylab(" ") +
geom_text(aes(label = percent), size = 3,hjust=-0.5) +
ggtitle("Aus welchen Gründen haben Sie sich für einen Ausflug in die\nBodenseeregion entschieden?") + xlim(0,30) +
theme(plot.title = element_text(size = 11, face = "bold"),legend.position="none",
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10,face = "bold"),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10,face = "bold"))
#ggsave("to_deliver/grund_ausflug.pdf")
# df_gruende <- gruende %>% as.data.frame()
#write.csv(df_gruende,"to_deliver/tables/gruende_ausflug.csv", row.names = F)
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list")) %>%
filter(., te_tourist_einheimisch == "tourist")
dp12_de <- dp12 %>% select(., c("te_anrainer_de")) %>% na.omit()
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list")) %>%
filter(., te_tourist_einheimisch == "tourist")
dp12_de <- dp12 %>% select(., c("te_anrainer_de")) %>% na.omit()
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list","te_anrainer_de")) %>%
filter(., te_tourist_einheimisch == "tourist")
dp12_de <- dp12 %>% select(., c("te_anrainer_de")) %>% na.omit()
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list","te_anrainer_de",
"te_anrainer_ch","te_anrainer_au")) %>%
filter(., te_tourist_einheimisch == "tourist")
dp12_de <- dp12 %>% select(., c("te_anrainer_de")) %>% na.omit()
dp12_ch <- dp12 %>% select(.,c("te_anrainer_ch")) %>% na.omit()
dp12_au <- dp12 %>% select(.,c("te_anrainer_au")) %>% na.omit()
View(dp12_de)
View(dp12_ch)
View(dp12_au)
dp12 <- data_all %>% select(.,c("te_gruende_tourist","te_tourist_einheimisch","befragungsort_list","te_anrainer_de",
"te_anrainer_ch","te_anrainer_au"))
View(dp12)
